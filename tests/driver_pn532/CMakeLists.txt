add_riot_module(test_driver_pn532 main.c)
add_executable(test_driver_pn532_i2c)
add_executable(test_driver_pn532_spi)
target_link_libraries(test_driver_pn532_i2c PUBLIC RIOT::RIOT)
target_link_libraries(test_driver_pn532_spi PUBLIC RIOT::RIOT)

set(RIOT_TEST_DRIVER_PN532_IRQ "0,1" CACHE STRING "IRQ pin used by test_driver_pn532_*")
set(RIOT_TEST_DRIVER_PN532_RESET "0,0" CACHE STRING "Reset pin used by test_driver_pn532_*")
set(RIOT_TEST_DRIVER_PN532_I2C "0" CACHE STRING "i2c bus used by test_driver_pn532_i2c")
set(RIOT_TEST_DRIVER_PN532_SPI "0" CACHE STRING "SPI bus used by test_driver_pn532_spi")
set(RIOT_TEST_DRIVER_PN532_NSS "0,2" CACHE STRING "Chip select pin used by test_driver_pn532_spi")
mark_as_advanced(RIOT_TEST_DRIVER_PN532_IRQ)
mark_as_advanced(RIOT_TEST_DRIVER_PN532_RESET)
mark_as_advanced(RIOT_TEST_DRIVER_PN532_I2C)
mark_as_advanced(RIOT_TEST_DRIVER_PN532_SPI)
mark_as_advanced(RIOT_TEST_DRIVER_PN532_NSS)

target_compile_definitions(riot_module_test_driver_pn532 INTERFACE "TEST_PN532_IRQ=GPIO_PIN(${RIOT_TEST_DRIVER_PN532_IRQ})")
target_compile_definitions(riot_module_test_driver_pn532 INTERFACE "TEST_PN532_RESET=GPIO_PIN(${RIOT_TEST_DRIVER_PN532_RESET})")
target_compile_definitions(test_driver_pn532_i2c PRIVATE "TEST_PN532_I2C=I2C_DEV(${RIOT_TEST_DRIVER_PN532_I2C})")
target_compile_definitions(test_driver_pn532_spi PRIVATE "TEST_PN532_SPI=SPI_DEV(${RIOT_TEST_DRIVER_PN532_SPI})")
target_compile_definitions(test_driver_pn532_spi PRIVATE "TEST_PN532_NSS=GPIO_PIN(${RIOT_TEST_DRIVER_PN532_NSS})")

riot_module_depends(test_driver_pn532 PUBLIC xtimer)
riot_target_depends(test_driver_pn532_i2c PUBLIC test_driver_pn532 pn532_i2c)
riot_target_depends(test_driver_pn532_spi PUBLIC test_driver_pn532 pn532_spi)
riot_check_missing_modules(test_driver_pn532_i2c)
riot_check_missing_modules(test_driver_pn532_spi)
