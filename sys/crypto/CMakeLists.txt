add_riot_module(crypto_aes OBJECT aes.c)
riot_module_depends(crypto_aes crypto)
add_riot_module(crypto_chacha OBJECT chacha.c)
riot_module_depends(crypto_chacha crypto)
add_riot_module(crypto_chacha20poly1305 OBJECT chacha20poly1305.c poly1305.c)
riot_module_depends(crypto_chacha20poly1305 crypto)
add_riot_module(crypto_chacha_prng OBJECT chacha_prng.c)
riot_module_depends(crypto_chacha_prng crypto_chacha)
add_riot_module(crypto OBJECT ciphers.c helper.c)

set(RIOT_CHACHA_PRNG_DEFAULT "" CACHE STRING "Override ChaCha PRNG default seed state, leave empty to generate one during configuration")
mark_as_advanced(RIOT_CHACHA_PRNG_DEFAULT)
if (NOT RIOT_CHACHA_PRNG_DEFAULT)
  set(seeds "")
  foreach (it RANGE 16)
    string(RANDOM LENGTH 8 ALPHABET "0123456789abcdef" seed)
    list(APPEND seeds "0x${seed}ull")
  endforeach()
  list(JOIN seeds "," RIOT_CHACHA_PRNG_DEFAULT)
  message(VERBOSE "Generated random RIOT_CHACHA_PRNG_DEFAULT: ${RIOT_CHACHA_PRNG_DEFAULT}")
endif()
target_compile_definitions(riot_module_crypto_chacha_prng PRIVATE "RIOT_CHACHA_PRNG_DEFAULT=${RIOT_CHACHA_PRNG_DEFAULT}")
