add_riot_module(crypto_aes aes.c)
riot_module_depends(crypto_aes crypto)
add_riot_module(crypto_chacha chacha.c)
riot_module_depends(crypto_chacha crypto)
add_riot_module(crypto_chacha20poly1305 chacha20poly1305.c poly1305.c)
riot_module_depends(crypto_chacha20poly1305 crypto)
add_riot_module(crypto_chacha_prng chacha_prng.c)
riot_module_depends(crypto_chacha_prng crypto_chacha)
add_riot_module(crypto ciphers.c helper.c)

set(RIOT_CHACHA_PRNG_DEFAULT "" CACHE STRING "Override ChaCha PRNG default seed state, leave empty to generate one during configuration")
mark_as_advanced(RIOT_CHACHA_PRNG_DEFAULT)
if (NOT RIOT_CHACHA_PRNG_DEFAULT)
  set(seeds "")
  foreach (it RANGE 16)
    string(RANDOM LENGTH 8 ALPHABET "0123456789abcdef" seed)
    list(APPEND seeds "0x${seed}ull")
  endforeach()
  list(JOIN seeds "," RIOT_CHACHA_PRNG_DEFAULT)
  message(VERBOSE "Generated random RIOT_CHACHA_PRNG_DEFAULT: ${RIOT_CHACHA_PRNG_DEFAULT}")
endif()
set_source_files_properties(chacha_prng.c PROPERTIES COMPILE_DEFINITIONS "RIOT_CHACHA_PRNG_DEFAULT=${RIOT_CHACHA_PRNG_DEFAULT}")
